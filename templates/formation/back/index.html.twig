{% extends 'baseRH.html.twig' %}

{% block title %}Liste des Formations - HR360
{% endblock %}

{% block heading %}Gestion des Formations
{% endblock %}

{% block css %}
	{{ parent() }}
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="{{ asset('back/css/project-card.css') }}">
	<link href="{{ asset('back/css/buttons.css') }}" rel="stylesheet">
	
	<style>
		.entity-card {
			border: 1px solid #e0e0e0;
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			margin-bottom: 20px;
			transition: all 0.3s ease;
		}

		.entity-card:hover {
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
			transform: translateY(-2px);
		}

		.entity-header {
			padding: 15px;
			border-bottom: 1px solid #eee;
			display: flex;
			align-items: center;
		}

		.entity-icon {
			margin-right: 10px;
			color: #4e73df;
			font-size: 1.5rem;
		}

		.entity-title {
			margin: 0;
			font-size: 1.1rem;
			color: #2c3e50;
		}

		.entity-body {
			padding: 15px;
		}

		.project-meta {
			display: flex;
			align-items: center;
			margin-bottom: 10px;
			font-size: 0.9rem;
		}

		.project-meta i {
			margin-right: 8px;
			color: #6c757d;
			width: 20px;
			text-align: center;
		}

		.entity-footer {
			padding: 15px;
			border-top: 1px solid #eee;
			background-color: #f8f9fa;
		}

		.action-buttons {
			display: flex;
			gap: 8px;
		}

		.btn-modify {
			background-color: #f6c23e;
			color: #2c3e50;
			border: none;
			padding: 6px 12px;
			border-radius: 4px;
			font-size: 0.85rem;
		}

		.btn-delete {
			background-color: #e74a3b;
			color: white;
			border: none;
			padding: 6px 12px;
			border-radius: 4px;
			font-size: 0.85rem;
		}


		.btn-view {
			background-color: #36b9cc;
			color: white;
			border: none;
			padding: 6px 12px;
			border-radius: 4px;
			font-size: 0.85rem;
		}

		.search-container {
			margin-bottom: 20px;
			display: flex;
			gap: 10px;
		}

		.search-container input {
			padding: 8px 12px;
			border: 1px solid #ddd;
			border-radius: 4px;
		}

		.search-container button {
			background-color: #4e73df;
			color: white;
			border: none;
			padding: 8px 16px;
			border-radius: 4px;
		}

		.add-btn {
			background-color: #1cc88a;
			color: white;
			border: none;
			padding: 8px 16px;
			border-radius: 4px;
			margin-bottom: 20px;
			display: inline-block;
		}

		.pagination {
			margin-top: 20px;
			display: flex;
			gap: 8px;
		}

		.pagination a,
		.pagination strong {
			padding: 8px 12px;
			border: 1px solid #ddd;
			border-radius: 4px;
		}

		.pagination strong {
			background-color: #4e73df;
			color: white;
			border-color: #4e73df;
		}
	</style>
{% endblock %}

{% block body %}
	<div class="container">

		<div class="search-container">
			<form method="get" action="{{ path('app_formation_index') }}" class="d-flex" style="gap: 10px;">
				<input type="text" name="search" value="{{ search }}" placeholder="Rechercher par titre...">
				<button type="submit">üîç Rechercher</button>
				<a href="{{ path('app_formation_index') }}" class="btn btn-secondary">R√©initialiser</a>
			</form>
		</div>

		<a href="{{ path('app_formation_new') }}" class="add-btn">
			<i class="fas fa-plus"></i>
			Ajouter une formation
		</a>

		<div class="row">
			{% for formation in formations %}
				<div class="col-md-4 mb-4">
					<div class="entity-card">
						<div class="entity-header">
							<div class="entity-icon">
								<i class="fas fa-graduation-cap"></i>
							</div>
							<h5 class="entity-title">{{ formation.titre }}</h5>
						</div>
						<div class="entity-body">
							<div class="project-meta">
								<i class="fas fa-align-left"></i>
								<span>{{ formation.description|u.truncate(50, '...') }}</span>
							</div>
							<div class="project-meta">
								<i class="fas fa-clock"></i>
								<span>Dur√©e:
									{{ formation.duree }}
									jours</span>
							</div>
							<div class="project-meta">
								<i class="fas fa-calendar-day"></i>
								<span>Date:
									{{ formation.dateFormation|date('d/m/Y') }}</span>
							</div>
						</div>
						<div class="entity-footer">
							<div class="action-buttons">
								<a href="{{ path('app_formation_show', {'id': formation.id}) }}" class="btn btn-view">
									<i class="fas fa-eye"></i>
									Voir
								</a>
								<a href="{{ path('app_formation_edit', {'id': formation.id}) }}" class="btn btn-modify">
									<i class="fas fa-edit"></i>
									Modifier
								</a>
								<form method="post" action="{{ path('app_formation_delete', {'id': formation.id}) }}" style="display: inline;">
									<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ formation.id) }}">
									<button type="submit" class="btn btn-delete" onclick="return confirm('Confirmer la suppression ?')">
										<i class="fas fa-trash"></i>
										Supprimer
									</button>
								</form>
							</div>
						</div>
					</div>
				</div>
			{% else %}
				<div class="col-12">
					<div class="alert alert-info">Aucune formation disponible.</div>
				</div>
			{% endfor %}
		</div>

		{% set totalPages = (total / limit)|round(0, 'ceil') %}
		{% if totalPages > 1 %}
			<div class="pagination">
				{% for i in 1..totalPages %}
					{% if i == page %}
						<strong>{{ i }}</strong>
					{% else %}
						<a href="{{ path('app_formation_index', {'page': i, 'search': search}) }}">{{ i }}</a>
					{% endif %}
				{% endfor %}
			</div>
		{% endif %}
	</div>
{% endblock %}
