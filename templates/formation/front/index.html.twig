{% extends 'baseEMP.html.twig' %}

{% block title %}Liste des Formations - HR360
{% endblock %}

{% block css %}
	{{ parent() }}
	<link rel="stylesheet" href="{{ asset('css/front/formation.css') }}">
{% endblock %}

{% block index %}
	<section id="formations" class="formations section">
		<div class="container section-title" data-aos="fade-up">
			<h2>Nos Formations</h2>
			<p>Découvrez notre catalogue de formations</p>
		</div>

		<div class="container">
			<div class="row mb-4">
				<div class="col-md-6">
					<form method="get" class="search-form">
						<div
							class="input-group">
							{# Initialiser search avec une valeur par défaut si non définie #}
							<input type="text" name="search" class="form-control" placeholder="Rechercher..." value="{{ app.request.query.get('search') ?? '' }}">
							<button class="btn btn-primary" type="submit">
								<i class="bi bi-search"></i>
							</button>
						</div>
					</form>
				</div>
				<div class="col-md-6 text-end">
					<a href="{{ path('app_formation_front_new') }}" class="btn btn-success">
						<i class="bi bi-plus-circle"></i>
						Nouvelle Formation
					</a>
				</div>
			</div>

			<div class="row">
				{% for formation in formations %}
					<div class="col-lg-4 col-md-6 mb-4" data-aos="fade-up" data-aos-delay="100">
						<div class="formation-card h-100">
							<div class="card-body">
								<h5 class="card-title">{{ formation.titre }}</h5>
								<p class="card-text text-muted">
									<i class="bi bi-calendar"></i>
									{{ formation.dateFormation }}
								</p>
								<p class="card-text">{{ formation.description|u.truncate(100, '...') }}</p>
								<div class="d-flex justify-content-between align-items-center">
									<a href="{{ path('app_formation_front_show', {'id': formation.id}) }}" class="btn btn-sm btn-primary">
										<i class="bi bi-eye"></i>
										Détails
									</a>
									<div>
										<span class="badge bg-primary me-2">{{ formation.duree }}
											jours</span>
										{% if formation.isFavorite %}
											<i class="bi bi-star-fill text-warning"></i>
										{% endif %}
									</div>
								</div>
							</div>
						</div>
					</div>
				{% else %}
					<div class="col-12" data-aos="fade-up">
						<div class="alert alert-info">
							Aucune formation trouvée.
						</div>
					</div>
				{% endfor %}
			</div>

			{% if total > limit %}
				<div class="row mt-4">
					<div class="col-12">
						<nav aria-label="Page navigation">
							<ul class="pagination justify-content-center">
								<li class="page-item {{ page == 1 ? 'disabled' : '' }}">
									<a class="page-link" href="{{ path('app_formation_front_index', {'page': page - 1, 'search': search}) }}">
										&laquo; Précédent
									</a>
								</li>

								{% for i in 1..((total / limit)|round(0, 'ceil')) %}
									<li class="page-item {{ page == i ? 'active' : '' }}">
										<a class="page-link" href="{{ path('app_formation_front_index', {'page': i, 'search': search}) }}">
											{{ i }}
										</a>
									</li>
								{% endfor %}

								<li class="page-item {{ page * limit >= total ? 'disabled' : '' }}">
									<a class="page-link" href="{{ path('app_formation_front_index', {'page': page + 1, 'search': search}) }}">
										Suivant &raquo;
									</a>
								</li>
							</ul>
						</nav>
					</div>
				</div>
			{% endif %}
		</div>
	</section>
{% endblock %}

{% block js %}
	{{ parent() }}
	<script>
		document.addEventListener('DOMContentLoaded', function () {
const formationCards = document.querySelectorAll('.formation-card');
formationCards.forEach((card, index) => {
card.style.animationDelay = `${
index * 0.1
}s`;
});
});
	</script>
{% endblock %}
