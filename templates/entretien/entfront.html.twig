{% extends 'baseCAN.html.twig' %}

{% block title %}Mes Entretiens - HR360{% endblock %}

{% block css %}
{{ parent() }}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

<style>
  .entretiens-section {
    padding: 80px 0;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  }
  
  .entretien-card {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    overflow: hidden;
    margin-bottom: 30px;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
    border: none;
    position: relative;
  }
  
  .entretien-card:before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(to bottom, #4e73df, #224abe);
  }
  
  .entretien-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
  }
  
  .entretien-header {
    padding: 20px 25px;
    background: #fff;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .entretien-title {
    margin: 0;
    font-size: 1.3rem;
    color: #2c3e50;
    font-weight: 700;
  }
  
  .entretien-badge {
    font-size: 0.8rem;
    padding: 0.5em 1em;
    border-radius: 50px;
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  }
  
  .badge-confirme {
    background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
    color: white;
  }
  
  .badge-attente {
    background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
    color: #212529;
  }
  
  .badge-annule {
    background: linear-gradient(135deg, #dc3545 0%, #bd2130 100%);
    color: white;
  }
  
  .entretien-body {
    padding: 25px;
  }
  
  .entretien-info {
    margin-bottom: 20px;
    position: relative;
    padding-left: 30px;
  }
  
  .entretien-info i {
    position: absolute;
    left: 0;
    top: 2px;
    color: #4e73df;
    font-size: 1.1rem;
  }
  
  .entretien-info strong {
    color: #4e73df;
    font-weight: 600;
    display: block;
    margin-bottom: 5px;
    font-size: 0.9rem;
  }
  
  .entretien-info p {
    color: #5a5c69;
    margin: 0;
    font-size: 1rem;
  }
  
  .entretien-footer {
    padding: 15px 25px;
    background: rgba(78, 115, 223, 0.05);
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    justify-content: flex-end;
    gap: 10px;
  }
  
  .btn-meet {
    background: #1a73e8;
    color: white;
    border: none;
    transition: all 0.3s;
  }
  
  .btn-meet:hover {
    background: #0d5bcd;
    color: white;
  }
  
  .btn-meet i {
    margin-right: 5px;
  }
  
  .btn-outline-primary {
    border-color: #4e73df;
    color: #4e73df;
    transition: all 0.3s;
  }
  
  .btn-outline-primary:hover {
    background: #4e73df;
    color: white;
  }
  
  .btn-outline-secondary {
    border-color: #858796;
    color: #858796;
    transition: all 0.3s;
  }
  
  .btn-outline-secondary:hover {
    background: #858796;
    color: white;
  }
  
  .no-entretiens {
    text-align: center;
    padding: 80px 0;
    background: white;
    border-radius: 12px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
  }
  
  .no-entretiens i {
    font-size: 4rem;
    color: #dddfeb;
    margin-bottom: 25px;
  }
  
  .no-entretiens h4 {
    color: #4e73df;
    font-weight: 700;
    margin-bottom: 15px;
  }
  
  .no-entretiens p {
    color: #858796;
    font-size: 1.1rem;
    max-width: 500px;
    margin: 0 auto;
  }
  
  .section-title {
    margin-bottom: 50px;
  }
  
  .section-title h2 {
    color: #4e73df;
    font-weight: 700;
    position: relative;
    display: inline-block;
    padding-bottom: 15px;
  }
  
  .section-title h2:after {
    content: '';
    position: absolute;
    left: 0;
    bottom: 0;
    width: 50px;
    height: 3px;
    background: linear-gradient(to right, #4e73df, #224abe);
  }
  
  .section-title p {
    color: #858796;
    font-size: 1.1rem;
  }

  .entretien-footer {
    padding: 15px 25px;
    background: rgba(78, 115, 223, 0.05);
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    display: flex;
    justify-content: flex-end;
    gap: 8px; /* Espacement réduit entre les boutons */
  }

  /* Style pour les boutons d'action */
  .btn-action {
    width: 40px;
    height: 40px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    transition: all 0.3s;
  }

  /* Style spécifique pour chaque bouton */
  .btn-view {
    background-color: #4e73df;
    color: white;
    border: none;
  }

  .btn-view:hover {
    background-color: #3a5bbf;
  }

  .btn-eval {
    background-color: #1cc88a;
    color: white;
    border: none;
  }

  .btn-eval:hover {
    background-color: #17a673;
  }

  .btn-quiz {
    background-color: #f6c23e;
    color: white;
    border: none;
  }

  .btn-quiz:hover {
    background-color: #dda20a;
  }

  .btn-show-quiz {
    background-color: #36b9cc;
    color: white;
    border: none;
  }

  .btn-show-quiz:hover {
    background-color: #2a8b9b;
  }

  /* Tooltip pour les boutons */
  [data-bs-toggle="tooltip"] {
    position: relative;
  }

  /* Responsive pour petits écrans */
  @media (max-width: 576px) {
    .entretien-footer {
      justify-content: center;
    }
  }

  .badge-primary {
    background: linear-gradient(135deg, #4e73df 0%, #224abe 100%);
    color: white;
  }
  
  .badge-success {
    background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
    color: white;
  }
  
  .badge-danger {
    background: linear-gradient(135deg, #dc3545 0%, #bd2130 100%);
    color: white;
  }
  
  .badge-secondary {
    background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
    color: white;
  }

  /* Styles pour la pagination */
  .pagination {
    display: flex;
    justify-content: center;
    margin-top: 30px;
  }
  
  .pagination .page-item.active .page-link {
    background-color: #4e73df;
    border-color: #4e73df;
    color: white;
  }
  
  .pagination .page-link {
    color: #4e73df;
    margin: 0 5px;
    border-radius: 8px;
    border: 1px solid #dee2e6;
    padding: 0.5rem 0.75rem;
  }
  
  .pagination .page-link:hover {
    background-color: #e9ecef;
  }
</style>
{% endblock %}

{% block index %}
<!-- Entretiens Section -->
<section id="entretiens" class="entretiens-section">
  <div class="container" data-aos="fade-up">
    <div class="section-title text-center">
      <h2>Mes Entretiens</h2>
      <p>Retrouvez ici tous vos entretiens programmés</p>
    </div>

    <div class="row">
      {% if entretiens|length > 0 %}
        {% for entretien in entretiens %}
        <div class="col-lg-6">
          <div class="entretien-card">
            <div class="entretien-header">
              <h3 class="entretien-title">Entretien</h3>
              <span class="entretien-badge 
                {% if entretien.statut.value == 'Planifié' %}badge-primary
                {% elseif entretien.statut.value == 'Terminé' %}badge-success
                {% elseif entretien.statut.value == 'Annulé' %}badge-danger
                {% elseif entretien.statut.value == 'Reporté' %}badge-secondary
                {% else %}badge-secondary{% endif %}">
                {{ entretien.statut.value }}
              </span>
            </div>
            <div class="entretien-body">
              <div class="row">
                <div class="col-md-6">
                  <div class="entretien-info">
                    <i class="bi bi-calendar-date"></i>
                    <strong>DATE</strong>
                    <p>{{ entretien.date ? entretien.date|date('d/m/Y') : 'Non définie' }}</p>
                  </div>
                  <div class="entretien-info">
                    <i class="bi bi-clock"></i>
                    <strong>HEURE</strong>
                    <p>{{ entretien.heure ? entretien.heure|date('H:i') : 'Non définie' }}</p>
                  </div>
                  <div class="entretien-info">
                    <i class="bi bi-gear"></i>
                    <strong>TYPE</strong>
                    <p>{{ entretien.type.value }}</p>
                  </div>
                </div>
                <div class="col-md-6">
                  {% if entretien.type.value == 'En_ligne' %}
                    <div class="entretien-info">
                      <i class="bi bi-camera-video"></i>
                      <strong>VISIOCONFÉRENCE</strong>
                      {% if entretien.lienmeet %}
                        <div class="d-grid mt-2">
                          <a href="{{ entretien.lienmeet }}" target="_blank" class="btn btn-meet">
                            <i class="bi bi-camera-video"></i> Rejoindre la réunion
                          </a>
                        </div>
                      {% else %}
                        <p class="text-muted mt-2">Lien non fourni</p>
                      {% endif %}
                    </div>
                  {% else %}
                    <div class="entretien-info">
                      <i class="bi bi-geo-alt"></i>
                      <strong>LIEU</strong>
                      <p>{{ entretien.localisation ?? 'Non spécifié' }}</p>
                    </div>
                  {% endif %}
                </div>
              </div>
            </div>
            <div class="entretien-footer">
                 <!-- Bouton Voir -->
              <a href="{{ path('app_entretien_show_front', {'idEntretien': entretien.idEntretien}) }}" 
                 class="btn-action btn-view" 
                 data-bs-toggle="tooltip" 
                 title="Voir les détails">
                <i class="fas fa-eye"></i>
              </a>
              
              <!-- Bouton Évaluations -->
              <a href="{{ path('app_evaluation_front_for_entretien', {'idEntretien': entretien.idEntretien}) }}" 
                 class="btn-action btn-eval" 
                 data-bs-toggle="tooltip" 
                 title="Voir les évaluations">
                <i class="fas fa-clipboard-check"></i>
              </a>
              
              <!-- Bouton Affecter Quiz -->
              <a href="#" 
                 class="btn-action btn-quiz" 
                 data-bs-toggle="tooltip" 
                 title="Affecter un quiz">
                <i class="fas fa-tasks"></i>
              </a>
              
              <!-- Bouton Afficher Quiz -->
              <a href="#" 
                 class="btn-action btn-show-quiz" 
                 data-bs-toggle="tooltip" 
                 title="Afficher le quiz">
                <i class="fas fa-question-circle"></i>
              </a>
                         
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="col-12">
          <div class="no-entretiens">
            <i class="bi bi-calendar-x"></i>
            <h4>Aucun entretien programmé</h4>
            <p>Vous n'avez pas d'entretiens prévus pour le moment. Nous vous informerons lorsqu'un entretien sera planifié.</p>
          </div>
        </div>
      {% endif %}
    </div>
  <!-- Pagination -->
    {% if totalPages > 1 %}
    <div class="row">
      <div class="col-12">
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-center">
            {% if page > 1 %}
              <li class="page-item">
                <a class="page-link" href="{{ path('app_entretien_front', {'page': page - 1}) }}" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                </a>
              </li>
            {% endif %}
            
            {% for i in 1..totalPages %}
              <li class="page-item {% if i == page %}active{% endif %}">
                <a class="page-link" href="{{ path('app_entretien_front', {'page': i}) }}">{{ i }}</a>
              </li>
            {% endfor %}
            
            {% if page < totalPages %}
              <li class="page-item">
                <a class="page-link" href="{{ path('app_entretien_front', {'page': page + 1}) }}" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                </a>
              </li>
            {% endif %}
          </ul>
        </nav>
      </div>
    </div>
    {% endif %}
  </div>
</section>
{% endblock %}
{% block javascripts %}
{{ parent() }}
<script>
// Initialisation des tooltips Bootstrap
$(document).ready(function(){
  $('[data-bs-toggle="tooltip"]').tooltip();
});
</script>
{% endblock %}